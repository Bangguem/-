<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아이디 및 비밀번호 찾기</title>
</head>

<body>
    <h1>아이디/비밀번호 찾기</h1>

    <section>
        <h2>아이디 찾기</h2>
        <form id="find-id-form">
            <label for="email-id">이메일 입력:</label>
            <input type="email" id="email-id" name="email" required>
            <button type="button" id="send-id-code">인증 코드 전송</button>
            <br><br>
            <label for="id-code">인증 코드 입력:</label>
            <input type="text" id="id-code" name="code" required>
            <button type="button" id="verify-id-code">아이디 찾기</button>
        </form>
        <p id="id-result" style="color: blue;"></p>
    </section>

    <section>
        <h2>비밀번호 찾기</h2>
        <form id="find-password-form">
            <label for="email-password">이메일 입력:</label>
            <input type="email" id="email-password" name="email" required>
            <button type="button" id="send-password-code">인증 코드 전송</button>
            <br><br>
            <label for="password-code">인증 코드 입력:</label>
            <input type="text" id="password-code" name="code" required>
            <br><br>
            <label for="new-password">새 비밀번호 입력:</label>
            <input type="password" id="new-password" name="newPassword" required>
            <button type="button" id="reset-password">비밀번호 변경</button>
        </form>
        <p id="password-result" style="color: blue;"></p>
    </section>

    <script>
        const API_BASE_URL = 'http://localhost:3000'; // 서버 주소

        // 아이디 찾기 - 인증 코드 전송
        document.getElementById('send-id-code').addEventListener('click', async () => {
            const email = document.getElementById('email-id').value;
            try {
                const response = await fetch(`${API_BASE_URL}/send-id-verification`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email }),
                });
                const result = await response.text();
                alert(result); // 성공/실패 메시지 표시
            } catch (error) {
                alert('오류 발생: ' + error.message);
            }
        });

        // 아이디 찾기 - 인증 코드 확인
        document.getElementById('verify-id-code').addEventListener('click', async () => {
            const email = document.getElementById('email-id').value;
            const code = document.getElementById('id-code').value;
            try {
                const response = await fetch(`${API_BASE_URL}/verify-id-code`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, code }),
                });
                const result = await response.text();
                document.getElementById('id-result').textContent = result;
            } catch (error) {
                alert('오류 발생: ' + error.message);
            }
        });

        // 비밀번호 찾기 - 인증 코드 전송
        document.getElementById('send-password-code').addEventListener('click', async () => {
            const email = document.getElementById('email-password').value;
            try {
                const response = await fetch(`${API_BASE_URL}/send-password-verification`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email }),
                });
                const result = await response.text();
                alert(result);
            } catch (error) {
                alert('오류 발생: ' + error.message);
            }
        });

        // 비밀번호 찾기 - 인증 코드 확인 및 변경
        document.getElementById('reset-password').addEventListener('click', async () => {
            const email = document.getElementById('email-password').value;
            const code = document.getElementById('password-code').value;
            const newPassword = document.getElementById('new-password').value;
            try {
                const response = await fetch(`${API_BASE_URL}/reset-password`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, code, newPassword }),
                });
                const result = await response.text();
                document.getElementById('password-result').textContent = result;
            } catch (error) {
                alert('오류 발생: ' + error.message);
            }
        });
    </script>
</body>

</html>